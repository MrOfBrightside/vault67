{"id":"di-2nq","title":"Witness Patrol","description":"Per-rig worker monitor patrol loop with progressive nudging.","status":"open","priority":2,"issue_type":"molecule","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:13.351984+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:13.351984+01:00"}
{"id":"di-2vn","title":"AI-powered recipe parsing from pasted text","description":"dispatched_by: mayor\n\nAllow users to paste recipe text and automatically parse it using AI, match ingredients to Livsmedelsverket database, and calculate nutrition.\n\nUser Flow:\n1. User pastes recipe text (from website, cookbook, etc.)\n2. AI model parses the text and extracts:\n   - Recipe name\n   - Servings/portions\n   - Ingredients with quantities and units\n   - Instructions (optional)\n3. For each ingredient:\n   - Search Livsmedelsverket API to find matching food\n   - Let user confirm/adjust matches\n   - Convert quantities to grams if needed\n4. Calculate total nutrition for the recipe\n5. Save as a new recipe with all ingredients linked\n\nTechnical Requirements:\n- Add a 'Paste Recipe' button/modal in RecipesPage\n- Integrate with AI model (Claude API or similar) for text parsing\n- Create a structured prompt to extract ingredients reliably\n- Handle Swedish and English ingredient names\n- Support common units (g, kg, dl, ml, msk, tsk, st, etc.)\n- Fuzzy matching for Livsmedelsverket food search\n- Review/confirmation step before saving\n- Calculate per-serving and total nutrition\n\nDependencies:\n- di-iaf: Add Livsmedelsverket food search to recipe creation (should be completed first)","status":"hooked","priority":2,"issue_type":"feature","assignee":"DietistApp/polecats/flint","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T09:28:46.505822+01:00","created_by":"jesper","updated_at":"2026-01-30T10:06:08.897978+01:00","dependencies":[{"issue_id":"di-2vn","depends_on_id":"di-iaf","type":"blocks","created_at":"2026-01-30T09:29:01.245122+01:00","created_by":"jesper"},{"issue_id":"di-2vn","depends_on_id":"di-8kn","type":"blocks","created_at":"2026-01-30T10:12:41.933377+01:00","created_by":"jesper"}]}
{"id":"di-45o","title":"Add caching for Livsmedelsverket food search","description":"dispatched_by: mayor\n\nThe food search from Livsmedelsverket API is slow. Add caching to improve performance.\n\nCurrent situation:\n- Each search query hits the external API\n- LivsmedelsverketService already has FoodCacheEntity for individual food lookups\n- But search results are not cached\n\nImplementation:\n1. Cache search results in Redis or in-memory cache\n2. Use a reasonable TTL (e.g., 1 hour for search results)\n3. Cache key should be the search query (normalized/lowercase)\n4. Consider using the existing NutrientCacheEntity pattern or add a new SearchCacheEntity\n5. Add cache invalidation strategy if needed\n\nAlternative approach:\n- Pre-fetch and store common foods in local database\n- Use database full-text search instead of API calls\n- This would be faster but requires periodic sync with Livsmedelsverket","status":"hooked","priority":1,"issue_type":"feature","assignee":"DietistApp/polecats/basalt","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T13:53:04.174523+01:00","created_by":"jesper","updated_at":"2026-01-30T13:53:30.058765+01:00"}
{"id":"di-4f3","title":"Merge: di-56i","description":"branch: polecat/opal/di-56i@mkwlw0uu\ntarget: main\nsource_issue: di-56i\nrig: DietistApp\nworker: opal\nagent_bead: di-DietistApp-polecat-opal\nretry_count: 0\nlast_conflict_sha: null\nconflict_task_id: null","status":"closed","priority":1,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T20:46:04.112509+01:00","created_by":"DietistApp/polecats/opal","updated_at":"2026-01-27T20:46:44.456456+01:00","closed_at":"2026-01-27T20:46:44.456456+01:00","close_reason":"Branch polecat/opal/di-56i@mkwlw0uu never pushed - polecat cleaned up, work lost","labels":["gt:merge-request"],"ephemeral":true}
{"id":"di-4ur","title":"Deacon Patrol","description":"Mayor's daemon patrol loop for handling callbacks, health checks, and cleanup.","status":"open","priority":2,"issue_type":"molecule","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:13.210917+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:13.210917+01:00"}
{"id":"di-4va","title":"Implement RecipesPage CRUD","description":"dispatched_by: mayor\n\nImplement recipe management UI: list recipes, create new recipe with ingredients, edit existing recipes, delete recipes. Connect to /api/recipes endpoints.","status":"closed","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/topaz","owner":"jesper@logikfabriken.se","created_at":"2026-01-29T12:22:49.135066+01:00","created_by":"jesper","updated_at":"2026-01-29T12:34:39.022565+01:00","closed_at":"2026-01-29T12:34:39.022565+01:00","close_reason":"PR merged to main"}
{"id":"di-56i","title":"task","description":"dispatched_by: mayor\n\nConnect ClientDiaryPage, DietitianDashboard, and Recipe pages to backend API services. Implement food search UI, entry creation forms, and nutrition summary displays.","status":"closed","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/opal","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:04:09.593786+01:00","created_by":"jesper","updated_at":"2026-01-27T20:46:06.54463+01:00","closed_at":"2026-01-27T20:46:06.54463+01:00","close_reason":"Closed"}
{"id":"di-8ek","title":"Add frontend error boundaries and loading states","description":"dispatched_by: mayor\n\nAdd React error boundary components, consistent loading spinners/skeletons, and user-friendly error messages throughout the app.","status":"closed","priority":2,"issue_type":"task","assignee":"DietistApp/polecats/ruby","owner":"jesper@logikfabriken.se","created_at":"2026-01-29T12:22:50.813046+01:00","created_by":"jesper","updated_at":"2026-01-30T09:05:39.435121+01:00","closed_at":"2026-01-30T09:05:39.435121+01:00","close_reason":"PR merged to main"}
{"id":"di-8kn","title":"Fix frontend JS errors and test all pages","description":"dispatched_by: mayor\n\nFix any remaining frontend JavaScript/TypeScript errors and verify all pages work:\n\nIssues to address:\n1. UserRole export error - CommonJS/ESM conflict (compiled .js files in shared/src)\n2. Test all pages load without errors:\n   - /login\n   - /register\n   - /recipes (including food search in create modal)\n   - /dashboard\n   - /diary\n\nRequirements:\n- Clean any compiled files from packages/shared/src/\n- Verify Vite dev server runs without errors\n- Test each page loads correctly\n- Verify no console errors\n- Test the Livsmedelsverket food search in recipe creation\n\nThis should be completed before the AI recipe parsing feature (di-2vn).","status":"closed","priority":1,"issue_type":"bug","assignee":"DietistApp/polecats/granite","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T10:12:36.460725+01:00","created_by":"jesper","updated_at":"2026-01-30T15:13:51.373229+01:00","closed_at":"2026-01-30T15:13:51.373229+01:00","close_reason":"Frontend working - user can create recipes, food search works with real API"}
{"id":"di-95a","title":"task","description":"dispatched_by: mayor\n\nImplement token validation in authStore.checkAuth() to verify tokens on app load and refresh if needed.","status":"closed","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/onyx","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:04:10.403093+01:00","created_by":"jesper","updated_at":"2026-01-27T14:04:55.096546+01:00","closed_at":"2026-01-27T14:04:55.096546+01:00","close_reason":"Closed"}
{"id":"di-DietistApp-crew-jesper","title":"Crew worker jesper in DietistApp - human-managed persistent workspace.","description":"Crew worker jesper in DietistApp - human-managed persistent workspace.\n\nrole_type: crew\nrig: DietistApp\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:21.764605+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:21.764605+01:00","labels":["gt:agent"]}
{"id":"di-DietistApp-polecat-amber","title":"di-DietistApp-polecat-amber","description":"di-DietistApp-polecat-amber\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-wnb\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T09:20:29.664342+01:00","created_by":"jesper","updated_at":"2026-01-30T09:20:29.73984+01:00","labels":["gt:agent"],"hook_bead":"di-wnb"}
{"id":"di-DietistApp-polecat-basalt","title":"di-DietistApp-polecat-basalt","description":"di-DietistApp-polecat-basalt\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-45o\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T13:53:13.362266+01:00","created_by":"jesper","updated_at":"2026-01-30T13:53:13.435088+01:00","labels":["gt:agent"],"hook_bead":"di-45o"}
{"id":"di-DietistApp-polecat-flint","title":"di-DietistApp-polecat-flint","description":"di-DietistApp-polecat-flint\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-2vn\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T10:05:52.51381+01:00","created_by":"jesper","updated_at":"2026-01-30T10:05:52.592782+01:00","labels":["gt:agent"],"hook_bead":"di-2vn"}
{"id":"di-DietistApp-polecat-garnet","title":"di-DietistApp-polecat-garnet","description":"di-DietistApp-polecat-garnet\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-vnu\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T08:46:30.598163+01:00","created_by":"jesper","updated_at":"2026-01-30T08:47:25.380556+01:00","labels":["gt:agent"],"hook_bead":"di-vnu"}
{"id":"di-DietistApp-polecat-granite","title":"di-DietistApp-polecat-granite","description":"di-DietistApp-polecat-granite\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-8kn\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T10:12:48.357631+01:00","created_by":"jesper","updated_at":"2026-01-30T10:12:48.475099+01:00","labels":["gt:agent"],"hook_bead":"di-8kn"}
{"id":"di-DietistApp-polecat-jade","title":"di-DietistApp-polecat-jade","description":"di-DietistApp-polecat-jade\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-iaf\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T09:25:54.54254+01:00","created_by":"jesper","updated_at":"2026-01-30T09:25:54.61675+01:00","labels":["gt:agent"],"hook_bead":"di-iaf"}
{"id":"di-DietistApp-polecat-jasper","title":"di-DietistApp-polecat-jasper","description":"di-DietistApp-polecat-jasper\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-bq5\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:01:34.250027+01:00","created_by":"jesper","updated_at":"2026-01-27T14:01:34.343497+01:00","labels":["gt:agent"],"hook_bead":"di-bq5"}
{"id":"di-DietistApp-polecat-marble","title":"di-DietistApp-polecat-marble","description":"di-DietistApp-polecat-marble\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-jfs\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T15:12:19.374719+01:00","created_by":"jesper","updated_at":"2026-01-30T15:12:19.449266+01:00","labels":["gt:agent"],"hook_bead":"di-jfs"}
{"id":"di-DietistApp-polecat-obsidian","title":"di-DietistApp-polecat-obsidian","description":"di-DietistApp-polecat-obsidian\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-eqq\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:59:34.405343+01:00","created_by":"jesper","updated_at":"2026-01-29T12:23:01.257659+01:00","labels":["gt:agent"],"hook_bead":"di-eqq"}
{"id":"di-DietistApp-polecat-onyx","title":"di-DietistApp-polecat-onyx","description":"di-DietistApp-polecat-onyx\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-4va\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:01:56.898695+01:00","created_by":"jesper","updated_at":"2026-01-29T12:23:19.79185+01:00","labels":["gt:agent"],"hook_bead":"di-4va"}
{"id":"di-DietistApp-polecat-opal","title":"di-DietistApp-polecat-opal","description":"di-DietistApp-polecat-opal\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-eqq\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:02:21.094283+01:00","created_by":"jesper","updated_at":"2026-01-29T12:23:43.853397+01:00","labels":["gt:agent"],"hook_bead":"di-eqq"}
{"id":"di-DietistApp-polecat-pearl","title":"di-DietistApp-polecat-pearl","description":"di-DietistApp-polecat-pearl\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-2vn\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T10:05:29.050863+01:00","created_by":"jesper","updated_at":"2026-01-30T10:05:29.120206+01:00","labels":["gt:agent"],"hook_bead":"di-2vn"}
{"id":"di-DietistApp-polecat-quartz","title":"di-DietistApp-polecat-quartz","description":"di-DietistApp-polecat-quartz\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-56i\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:00:19.05385+01:00","created_by":"jesper","updated_at":"2026-01-27T14:00:19.13142+01:00","labels":["gt:agent"],"hook_bead":"di-56i"}
{"id":"di-DietistApp-polecat-ruby","title":"di-DietistApp-polecat-ruby","description":"di-DietistApp-polecat-ruby\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-8ek\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T08:46:49.51563+01:00","created_by":"jesper","updated_at":"2026-01-30T08:47:27.004722+01:00","labels":["gt:agent"],"hook_bead":"di-8ek"}
{"id":"di-DietistApp-polecat-topaz","title":"di-DietistApp-polecat-topaz","description":"di-DietistApp-polecat-topaz\n\nrole_type: polecat\nrig: DietistApp\nagent_state: spawning\nhook_bead: di-4va\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:02:40.861844+01:00","created_by":"jesper","updated_at":"2026-01-29T12:24:03.423873+01:00","labels":["gt:agent"],"hook_bead":"di-4va"}
{"id":"di-DietistApp-refinery","title":"Refinery for DietistApp - processes merge queue.","description":"Refinery for DietistApp - processes merge queue.\n\nrole_type: refinery\nrig: DietistApp\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:12.984491+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:12.984491+01:00","labels":["gt:agent"]}
{"id":"di-DietistApp-witness","title":"Witness for DietistApp - monitors polecat health and progress.","description":"Witness for DietistApp - monitors polecat health and progress.\n\nrole_type: witness\nrig: DietistApp\nagent_state: idle\nhook_bead: null\ncleanup_status: null\nactive_mr: null\nnotification_level: null","status":"open","priority":2,"issue_type":"agent","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:12.734961+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:12.734961+01:00","labels":["gt:agent"]}
{"id":"di-au4","title":"task","description":"Create GitHub Actions workflow for automated testing, building, and deployment. Include Docker image builds and container registry push.","status":"closed","priority":2,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:04:10.212012+01:00","created_by":"jesper","updated_at":"2026-01-29T12:22:32.712474+01:00","closed_at":"2026-01-29T12:22:32.712474+01:00","close_reason":"Already completed per PROGRESS.md"}
{"id":"di-bq5","title":"task","description":"dispatched_by: mayor\n\nAdd Jest unit tests for backend services (auth, foods, entries, recipes). Add frontend component tests. Target minimum 70% coverage.","status":"closed","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/topaz","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:04:09.818808+01:00","created_by":"jesper","updated_at":"2026-01-27T20:47:16.67797+01:00","closed_at":"2026-01-27T20:47:16.67797+01:00","close_reason":"Closed"}
{"id":"di-c4f","title":"Digest: mol-witness-patrol","description":"Patrol 1: Escalated 4 broken polecats to Mayor (no .git repos). Refinery healthy. New POLECAT_DONE from obsidian/onyx pending.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-27T14:05:48.862751+01:00","updated_at":"2026-01-27T14:05:48.862751+01:00","closed_at":"2026-01-27T14:05:48.862712+01:00","close_reason":"Squashed from 10 wisps","dependencies":[{"issue_id":"di-c4f","depends_on_id":"di-wisp-cmb","type":"parent-child","created_at":"2026-01-27T14:05:48.863386+01:00","created_by":"DietistApp/witness"}]}
{"id":"di-clf","title":"Merge: di-95a","description":"branch: polecat/obsidian/di-95a@mkwlsg2i\ntarget: main\nsource_issue: di-95a\nrig: DietistApp\nworker: obsidian\nagent_bead: di-DietistApp-polecat-obsidian\nretry_count: 0\nlast_conflict_sha: null\nconflict_task_id: null","status":"closed","priority":1,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:05:17.221774+01:00","created_by":"DietistApp/polecats/obsidian","updated_at":"2026-01-27T20:44:48.207109+01:00","closed_at":"2026-01-27T20:44:48.207109+01:00","close_reason":"Branch polecat/obsidian/di-95a@mkwlsg2i never pushed - polecat cleaned up","labels":["gt:merge-request"],"ephemeral":true}
{"id":"di-eqq","title":"Implement DietitianDashboardPage","description":"dispatched_by: mayor\n\nConnect DietitianDashboardPage to backend APIs. Show list of clients, allow navigation to individual client diary pages. Use existing API endpoints.","status":"closed","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/opal","owner":"jesper@logikfabriken.se","created_at":"2026-01-29T12:22:43.531745+01:00","created_by":"jesper","updated_at":"2026-01-29T12:34:39.030538+01:00","closed_at":"2026-01-29T12:34:39.030538+01:00","close_reason":"PR merged to main"}
{"id":"di-iaf","title":"Add Livsmedelsverket food search to recipe creation","description":"dispatched_by: mayor\n\nEnhance recipe creation to allow searching for foods from Livsmedelsverket's API.\n\nRequirements:\n1. Add a food search component to the recipe creation/edit form\n2. Use the existing LivsmedelsverketService (/api/foods/search endpoint)\n3. Allow users to search for foods by name\n4. Display search results with food name and number\n5. Let users select a food to add as an ingredient\n6. Auto-populate nutrition data from the selected food\n7. Allow specifying quantity/amount for the ingredient\n\nAPI Reference: https://www.livsmedelsverket.se/om-oss/psidata/livsmedelsdatabasen/\n\nThe backend already has:\n- GET /api/foods/search?query=... - Search foods\n- GET /api/foods/:foodNumber - Get food details\n- GET /api/foods/:foodNumber/nutrients - Get nutrition data\n\nFrontend needs:\n- Food search input with autocomplete/typeahead in RecipesPage\n- Display search results in a dropdown\n- Add selected food as recipe ingredient with amount input\n- Show nutrition summary for recipe","status":"closed","priority":1,"issue_type":"feature","assignee":"DietistApp/polecats/jade","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T09:25:47.414869+01:00","created_by":"jesper","updated_at":"2026-01-30T10:05:22.066436+01:00","closed_at":"2026-01-30T10:05:22.066436+01:00","close_reason":"PR #7 merged - Livsmedelsverket food search implemented in RecipesPage"}
{"id":"di-jfs","title":"Add nutrition calculation display to RecipesPage","description":"dispatched_by: mayor\n\nThe RecipesPage shows recipes with ingredients but doesn't display any nutrition values.\n\nCurrent state:\n- Recipe viewing modal shows: name, servings, description, ingredients (name, grams), dates\n- No calories, protein, carbs, fat displayed\n\nRequirements:\n1. Backend: Add endpoint GET /api/recipes/:id/nutrition that calculates total nutrition\n   - Use LivsmedelverketService.getNutrientsByFoodNumber() for each ingredient\n   - Sum up values weighted by grams\n   - Return: calories, protein, carbs, fat, fiber (per serving and total)\n\n2. Frontend: Display nutrition in RecipesPage\n   - Show nutrition summary in recipe cards (calories per serving)\n   - Show detailed nutrition in view modal:\n     - Per serving values\n     - Total recipe values\n     - Per ingredient breakdown (optional)\n\n3. Use existing NutritionCalculationService as reference\n\nThe API endpoint /api/foods/:foodNumber/nutrients already exists and returns nutrient data.","status":"hooked","priority":1,"issue_type":"feature","assignee":"DietistApp/polecats/marble","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T15:12:11.009797+01:00","created_by":"jesper","updated_at":"2026-01-30T15:12:36.041404+01:00"}
{"id":"di-jup","title":"Merge: di-bq5","description":"branch: polecat/topaz/di-bq5@mkwlwg34\ntarget: main\nsource_issue: di-bq5\nrig: DietistApp\nworker: topaz\nagent_bead: di-DietistApp-polecat-topaz\nretry_count: 0\nlast_conflict_sha: null\nconflict_task_id: null","status":"closed","priority":1,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T20:47:14.461246+01:00","created_by":"DietistApp/polecats/topaz","updated_at":"2026-01-29T12:23:45.738615+01:00","closed_at":"2026-01-29T12:23:45.738615+01:00","close_reason":"Branch polecat/topaz/di-bq5@mkwlwg34 never pushed - polecat cleaned up, work lost","labels":["gt:merge-request"],"ephemeral":true}
{"id":"di-puv","title":"task","description":"Implement /health and /ready endpoints as documented in README. Add liveness and readiness probes.","status":"closed","priority":2,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T13:04:10.024304+01:00","created_by":"jesper","updated_at":"2026-01-29T12:22:32.702466+01:00","closed_at":"2026-01-29T12:22:32.702466+01:00","close_reason":"Already completed per PROGRESS.md"}
{"id":"di-qzn","title":"Merge: di-95a","description":"branch: polecat/onyx/di-95a@mkwlvi74\ntarget: main\nsource_issue: di-95a\nrig: DietistApp\nworker: onyx\nagent_bead: di-DietistApp-polecat-onyx\nretry_count: 0\nlast_conflict_sha: null\nconflict_task_id: null","status":"closed","priority":1,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T14:04:52.677949+01:00","created_by":"DietistApp/polecats/onyx","updated_at":"2026-01-27T20:44:48.99302+01:00","closed_at":"2026-01-27T20:44:48.99302+01:00","close_reason":"Branch polecat/onyx/di-95a@mkwlvi74 never pushed - polecat cleaned up","labels":["gt:merge-request"],"ephemeral":true}
{"id":"di-rig-DietistApp","title":"DietistApp","description":"Rig identity bead for DietistApp.\n\nrepo: https://github.com/MrOfBrightside/DietistApp.git\nprefix: di\nstate: active","status":"open","priority":2,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:13.589862+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:13.589862+01:00","labels":["gt:rig"]}
{"id":"di-vnu","title":"Complete Register page","description":"dispatched_by: mayor\n\nComplete the registration page implementation. Add form validation, role selection (CLIENT/DIETITIAN), error handling, and redirect after successful registration.","status":"closed","priority":2,"issue_type":"task","assignee":"DietistApp/polecats/garnet","owner":"jesper@logikfabriken.se","created_at":"2026-01-29T12:22:50.057308+01:00","created_by":"jesper","updated_at":"2026-01-30T09:05:39.425744+01:00","closed_at":"2026-01-30T09:05:39.425744+01:00","close_reason":"PR merged to main"}
{"id":"di-wisp-1a7","title":"Process witness mail","description":"Check inbox and handle messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**POLECAT_STARTED**:\nA new polecat has started working. Acknowledge and archive.\n```bash\n# Acknowledge startup (optional: log for activity tracking)\ngt mail archive \u003cmessage-id\u003e\n```\nNo action needed beyond acknowledgment - archive immediately.\n\n**POLECAT_DONE / LIFECYCLE:Shutdown**:\n\n*EPHEMERAL MODEL*: Polecats are truly ephemeral - done at MR submission,\nrecyclable immediately. Once the branch is pushed (cleanup_status=clean),\nthe polecat can be nuked. The MR lifecycle continues independently in the\nRefinery. If conflicts arise, Refinery creates a NEW conflict-resolution\ntask for a NEW polecat.\n\nPolecat lifecycle: spawning → working → mr_submitted → nuked\nMR lifecycle: created → queued → processed → merged (handled by Refinery)\n\nThe handler (HandlePolecatDone) will:\n1. Check cleanup_status from agent bead\n2. If \"clean\" (branch pushed): AUTO-NUKE immediately, archive mail\n3. If dirty: Create cleanup wisp for manual intervention\n\n```bash\n# The handler does this automatically:\n# - For clean state: gt polecat nuke \u003cname\u003e → archive mail\n# - For dirty state: create wisp → process in next step\n```\n\nCleanup wisps are only created when something is wrong (uncommitted changes,\nunpushed commits). Most POLECAT_DONE messages result in immediate nuke.\n\n**MERGED**:\nA branch was merged successfully. This is informational in the ephemeral model\nsince the polecat was already nuked after MR submission.\n\nIf a cleanup wisp exists (dirty state), complete the cleanup:\n```bash\n# Find the cleanup wisp for this polecat\nbd list --wisp --labels=polecat:\u003cname\u003e,state:merge-requested --status=open\n\n# If found, proceed with full polecat nuke:\ngt polecat nuke \u003cname\u003e\n\n# Burn the cleanup wisp\nbd close \u003cwisp-id\u003e\n```\nArchive after cleanup is complete.\n\n**HELP / Blocked**:\nAssess the request. Can you help? If not, escalate to Mayor:\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e needs help\" -m \"\u003cdetails\u003e\"\n```\nArchive after handling (escalated or resolved):\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Continue from where they left off.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**SWARM_START**:\nMayor initiating batch polecat work. Initialize swarm tracking.\n```bash\n# Parse swarm info from mail body: {\"swarm_id\": \"batch-123\", \"beads\": [\"bd-a\", \"bd-b\"]}\nbd create --wisp --title \"swarm:\u003cswarm_id\u003e\" --description \"Tracking batch: \u003cswarm_id\u003e\" --labels swarm,swarm_id:\u003cswarm_id\u003e,total:\u003cN\u003e,completed:0,start:\u003ctimestamp\u003e\n```\nArchive after creating swarm tracking wisp:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: active work, unprocessed requests. Inbox should be near-empty.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:59:50.470357+01:00","updated_at":"2026-01-27T13:59:50.470357+01:00","ephemeral":true}
{"id":"di-wisp-3cu","title":"Process pending cleanup wisps","description":"Process cleanup wisps (exception handling for dirty polecats).\n\nIn the ephemeral model, cleanup wisps are only created when a polecat has\ndirty state (uncommitted changes, unpushed commits) that prevented immediate\nnuke. Most polecats are nuked immediately on POLECAT_DONE and never create wisps.\n\n```bash\n# Find all cleanup wisps\nbd list --wisp --labels=cleanup --status=open\n```\n\nIf no wisps, skip this step (most common case in ephemeral model).\n\nFor each cleanup wisp, investigate and resolve the dirty state:\n\n## State: pending (needs investigation)\n\n1. **Extract polecat name** from wisp title/labels\n\n2. **Diagnose the problem**:\n```bash\ncd polecats/\u003cname\u003e\ngit status                    # What's uncommitted?\ngit stash list                # Any stashed work?\ngit log origin/main..HEAD     # Any unpushed commits?\n```\n\n3. **Resolution options**:\n   - **Uncommitted changes**: Commit and push, then nuke\n   - **Stashed work**: Pop and commit, or discard if not valuable\n   - **Unpushed commits**: Push to origin, then nuke\n   - **All valuable work lost**: Escalate to Mayor for recovery\n\n4. **If resolvable locally**: Fix and nuke\n```bash\n# Example: push unpushed commits\ngit push origin HEAD\n\n# Then nuke\ngt polecat nuke \u003cname\u003e\n\n# Close the wisp\nbd close \u003cwisp-id\u003e --reason \"Resolved: pushed commits, nuked\"\n```\n\n5. **If needs escalation**: Send RECOVERY_NEEDED to Mayor\n```bash\ngt mail send mayor/ -s \"RECOVERY_NEEDED \u003crig\u003e/\u003cpolecat\u003e\" \\\n  -m \"Cleanup Status: \u003cstatus\u003e\nBranch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\n\nCannot auto-resolve. Please advise.\"\n```\nLeave wisp open until Mayor resolves.\n\n## State: merge-requested (legacy, rare)\n\nThis state was used before the ephemeral model. If found, the polecat is\nwaiting for a MERGED signal. The inbox-check step handles these.\n\n**Parallelism**: Use Task tool subagents to process multiple cleanups concurrently.\nEach cleanup is independent - perfect for parallel execution.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:59:50.470602+01:00","updated_at":"2026-01-27T13:59:50.470603+01:00","dependencies":[{"issue_id":"di-wisp-3cu","depends_on_id":"di-wisp-1a7","type":"blocks","created_at":"2026-01-27T13:59:50.477336+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-3z6","title":"Loop or exit for respawn","description":"End of patrol cycle decision.\n\n**If context LOW** (can continue patrolling):\n1. Generate a brief summary of this patrol cycle\n2. Squash the current wisp:\n```bash\nbd mol squash \u003cmol-id\u003e --summary \"\u003cpatrol-summary\u003e\"\n```\n3. Create a new patrol wisp:\n```bash\nbd mol wisp mol-witness-patrol\n```\n4. Continue executing from the inbox-check step of the new wisp\n\n**If context HIGH** (approaching limit):\n1. Write handoff mail with notable observations:\n```bash\ngt handoff -s \"Witness patrol handoff\" -m \"\u003cobservations\u003e\"\n```\n2. Exit cleanly - the daemon will respawn a fresh Witness session\n\n**IMPORTANT**: You must either create a new wisp (context LOW) or exit (context HIGH).\nNever leave the session idle without work on your hook.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.062828+01:00","updated_at":"2026-01-27T14:06:02.062828+01:00","dependencies":[{"issue_id":"di-wisp-3z6","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.068978+01:00","created_by":"witness"},{"issue_id":"di-wisp-3z6","depends_on_id":"di-wisp-frp","type":"blocks","created_at":"2026-01-27T14:06:02.073798+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-5yi","title":"Check if active swarm is complete","description":"If Mayor started a batch (SWARM_START), check if all polecats have completed.\n\n**Step 1: Find active swarm tracking wisps**\n```bash\nbd list --wisp --labels=swarm --status=open\n```\nIf no active swarm, skip this step.\n\n**Step 2: Count completed polecats for this swarm**\n\nExtract from wisp labels: swarm_id, total, completed, start timestamp.\nCheck how many cleanup wisps have been closed for this swarm's polecats.\n\n**Step 3: If all complete, notify Mayor**\n```bash\ngt mail send mayor/ -s \"SWARM_COMPLETE: \u003cswarm_id\u003e\" -m \"All \u003ctotal\u003e polecats merged.\nDuration: \u003cminutes\u003e minutes\nSwarm: \u003cswarm_id\u003e\"\n\n# Close the swarm tracking wisp\nbd close \u003cswarm-wisp-id\u003e --reason \"All polecats merged\"\n```\n\nNote: Runs every patrol cycle. Notification sent exactly once when all complete.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:59:50.471377+01:00","updated_at":"2026-01-27T13:59:50.471377+01:00","ephemeral":true}
{"id":"di-wisp-76i","title":"Check timer gates for expiration","description":"Check for expired timer gates and escalate as needed.\n\nTimer gates are async wait conditions with a timeout. When the timeout expires,\nthe gate should be escalated to the overseer for human intervention.\n\n**Step 1: Run timer gate check**\n```bash\nbd gate check --type=timer --escalate\n```\n\nThis command:\n1. Finds all open gate issues with await_type=timer\n2. Checks if `now \u003e created_at + timeout`\n3. Escalates expired gates via `gt escalate` (HIGH severity)\n4. Reports summary of gate status\n\n**Step 2: Review output**\n\nIf expired gates were found and escalated:\n- The escalation creates an audit trail bead\n- Overseer will be notified via mail\n- Gate remains open until manually resolved\n\nIf no expired gates:\n- Continue patrol normally\n\n**Note**: Timer gates do NOT auto-close on expiration. They escalate.\nThis ensures human oversight of timeout conditions.\n\n**Parallelism**: This is a single command, no parallel execution needed.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.061964+01:00","updated_at":"2026-01-27T14:06:02.061964+01:00","dependencies":[{"issue_id":"di-wisp-76i","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.065705+01:00","created_by":"witness"},{"issue_id":"di-wisp-76i","depends_on_id":"di-wisp-wi6","type":"blocks","created_at":"2026-01-27T14:06:02.071188+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-7r7","title":"Process pending cleanup wisps","description":"Process cleanup wisps (exception handling for dirty polecats).\n\nIn the ephemeral model, cleanup wisps are only created when a polecat has\ndirty state (uncommitted changes, unpushed commits) that prevented immediate\nnuke. Most polecats are nuked immediately on POLECAT_DONE and never create wisps.\n\n```bash\n# Find all cleanup wisps\nbd list --wisp --labels=cleanup --status=open\n```\n\nIf no wisps, skip this step (most common case in ephemeral model).\n\nFor each cleanup wisp, investigate and resolve the dirty state:\n\n## State: pending (needs investigation)\n\n1. **Extract polecat name** from wisp title/labels\n\n2. **Diagnose the problem**:\n```bash\ncd polecats/\u003cname\u003e\ngit status                    # What's uncommitted?\ngit stash list                # Any stashed work?\ngit log origin/main..HEAD     # Any unpushed commits?\n```\n\n3. **Resolution options**:\n   - **Uncommitted changes**: Commit and push, then nuke\n   - **Stashed work**: Pop and commit, or discard if not valuable\n   - **Unpushed commits**: Push to origin, then nuke\n   - **All valuable work lost**: Escalate to Mayor for recovery\n\n4. **If resolvable locally**: Fix and nuke\n```bash\n# Example: push unpushed commits\ngit push origin HEAD\n\n# Then nuke\ngt polecat nuke \u003cname\u003e\n\n# Close the wisp\nbd close \u003cwisp-id\u003e --reason \"Resolved: pushed commits, nuked\"\n```\n\n5. **If needs escalation**: Send RECOVERY_NEEDED to Mayor\n```bash\ngt mail send mayor/ -s \"RECOVERY_NEEDED \u003crig\u003e/\u003cpolecat\u003e\" \\\n  -m \"Cleanup Status: \u003cstatus\u003e\nBranch: \u003cbranch\u003e\nIssue: \u003cissue-id\u003e\n\nCannot auto-resolve. Please advise.\"\n```\nLeave wisp open until Mayor resolves.\n\n## State: merge-requested (legacy, rare)\n\nThis state was used before the ephemeral model. If found, the polecat is\nwaiting for a MERGED signal. The inbox-check step handles these.\n\n**Parallelism**: Use Task tool subagents to process multiple cleanups concurrently.\nEach cleanup is independent - perfect for parallel execution.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.061339+01:00","updated_at":"2026-01-27T14:06:02.061339+01:00","dependencies":[{"issue_id":"di-wisp-7r7","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.064067+01:00","created_by":"witness"},{"issue_id":"di-wisp-7r7","depends_on_id":"di-wisp-9jq","type":"blocks","created_at":"2026-01-27T14:06:02.069483+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-8pr","title":"Check if active swarm is complete","description":"If Mayor started a batch (SWARM_START), check if all polecats have completed.\n\n**Step 1: Find active swarm tracking wisps**\n```bash\nbd list --wisp --labels=swarm --status=open\n```\nIf no active swarm, skip this step.\n\n**Step 2: Count completed polecats for this swarm**\n\nExtract from wisp labels: swarm_id, total, completed, start timestamp.\nCheck how many cleanup wisps have been closed for this swarm's polecats.\n\n**Step 3: If all complete, notify Mayor**\n```bash\ngt mail send mayor/ -s \"SWARM_COMPLETE: \u003cswarm_id\u003e\" -m \"All \u003ctotal\u003e polecats merged.\nDuration: \u003cminutes\u003e minutes\nSwarm: \u003cswarm_id\u003e\"\n\n# Close the swarm tracking wisp\nbd close \u003cswarm-wisp-id\u003e --reason \"All polecats merged\"\n```\n\nNote: Runs every patrol cycle. Notification sent exactly once when all complete.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.062122+01:00","updated_at":"2026-01-27T14:06:02.062122+01:00","dependencies":[{"issue_id":"di-wisp-8pr","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.066195+01:00","created_by":"witness"},{"issue_id":"di-wisp-8pr","depends_on_id":"di-wisp-76i","type":"blocks","created_at":"2026-01-27T14:06:02.071751+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-9jq","title":"Process witness mail","description":"Check inbox and handle messages.\n\n```bash\ngt mail inbox\n```\n\nFor each message:\n\n**POLECAT_STARTED**:\nA new polecat has started working. Acknowledge and archive.\n```bash\n# Acknowledge startup (optional: log for activity tracking)\ngt mail archive \u003cmessage-id\u003e\n```\nNo action needed beyond acknowledgment - archive immediately.\n\n**POLECAT_DONE / LIFECYCLE:Shutdown**:\n\n*EPHEMERAL MODEL*: Polecats are truly ephemeral - done at MR submission,\nrecyclable immediately. Once the branch is pushed (cleanup_status=clean),\nthe polecat can be nuked. The MR lifecycle continues independently in the\nRefinery. If conflicts arise, Refinery creates a NEW conflict-resolution\ntask for a NEW polecat.\n\nPolecat lifecycle: spawning → working → mr_submitted → nuked\nMR lifecycle: created → queued → processed → merged (handled by Refinery)\n\nThe handler (HandlePolecatDone) will:\n1. Check cleanup_status from agent bead\n2. If \"clean\" (branch pushed): AUTO-NUKE immediately, archive mail\n3. If dirty: Create cleanup wisp for manual intervention\n\n```bash\n# The handler does this automatically:\n# - For clean state: gt polecat nuke \u003cname\u003e → archive mail\n# - For dirty state: create wisp → process in next step\n```\n\nCleanup wisps are only created when something is wrong (uncommitted changes,\nunpushed commits). Most POLECAT_DONE messages result in immediate nuke.\n\n**MERGED**:\nA branch was merged successfully. This is informational in the ephemeral model\nsince the polecat was already nuked after MR submission.\n\nIf a cleanup wisp exists (dirty state), complete the cleanup:\n```bash\n# Find the cleanup wisp for this polecat\nbd list --wisp --labels=polecat:\u003cname\u003e,state:merge-requested --status=open\n\n# If found, proceed with full polecat nuke:\ngt polecat nuke \u003cname\u003e\n\n# Burn the cleanup wisp\nbd close \u003cwisp-id\u003e\n```\nArchive after cleanup is complete.\n\n**HELP / Blocked**:\nAssess the request. Can you help? If not, escalate to Mayor:\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e needs help\" -m \"\u003cdetails\u003e\"\n```\nArchive after handling (escalated or resolved):\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**HANDOFF**:\nRead predecessor context. Continue from where they left off.\nArchive after absorbing context:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**SWARM_START**:\nMayor initiating batch polecat work. Initialize swarm tracking.\n```bash\n# Parse swarm info from mail body: {\"swarm_id\": \"batch-123\", \"beads\": [\"bd-a\", \"bd-b\"]}\nbd create --wisp --title \"swarm:\u003cswarm_id\u003e\" --description \"Tracking batch: \u003cswarm_id\u003e\" --labels swarm,swarm_id:\u003cswarm_id\u003e,total:\u003cN\u003e,completed:0,start:\u003ctimestamp\u003e\n```\nArchive after creating swarm tracking wisp:\n```bash\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Hygiene principle**: Archive messages after they're fully processed.\nKeep only: active work, unprocessed requests. Inbox should be near-empty.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.061109+01:00","updated_at":"2026-01-27T14:06:02.061109+01:00","dependencies":[{"issue_id":"di-wisp-9jq","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.063268+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-bhf","title":"End-of-cycle inbox hygiene","description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nIn the ephemeral model, most POLECAT_DONE messages are handled immediately\n(auto-nuke) and archived. Inbox should contain ONLY:\n- Unprocessed messages (just arrived, will handle next cycle)\n- MERGED notifications (informational, archive after reading)\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- POLECAT_STARTED older than this cycle → archive\n- POLECAT_DONE that was auto-nuked → should be archived already\n- MERGED notifications → archive after acknowledging\n- HELP/Blocked that was escalated → archive\n- SWARM_START that created tracking wisp → archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Verify cleanup wisp hygiene**\n\nIn the ephemeral model, cleanup wisps should be rare (only for dirty polecats):\n```bash\nbd list --wisp --labels=cleanup --status=open\n```\n\n- state:pending → Needs investigation in process-cleanups\n- state:merge-requested → Legacy state, handle in inbox-check\n\nIf cleanup wisps are accumulating, investigate why polecats aren't clean.\n\n**Goal**: Inbox should be nearly empty. Cleanup wisps should be rare.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:59:50.471759+01:00","updated_at":"2026-01-27T13:59:50.471759+01:00","ephemeral":true}
{"id":"di-wisp-cmb","title":"mol-witness-patrol","description":"Per-rig worker monitor patrol loop.\n\nThe Witness is the Pit Boss for your rig. You watch polecats, nudge them toward\ncompletion, verify clean git state before kills, and escalate stuck workers.\n\n**You do NOT do implementation work.** Your job is oversight, not coding.\n\n## Ephemeral Polecat Model\n\nPolecats are truly ephemeral - done at MR submission, recyclable immediately:\n\n```\nPolecat lifecycle: spawning → working → mr_submitted → nuked\nMR lifecycle:      created → queued → processed → merged (Refinery handles)\n```\n\nOnce a polecat's branch is pushed (cleanup_status=clean), the polecat can be\nnuked immediately. The MR continues independently in the Refinery. If conflicts\narise, Refinery creates a NEW conflict-resolution task for a NEW polecat.\n\n**Key principle**: Polecat lifecycle is separate from MR lifecycle.\n\n## Design Philosophy\n\nThis patrol follows Gas Town principles:\n- **Discovery over tracking**: Observe reality each cycle, don't maintain state\n- **Events over state**: POLECAT_DONE mail triggers immediate cleanup\n- **Ephemeral by default**: Clean polecats are nuked immediately, no waiting\n- **Cleanup wisps for exceptions**: Only created when intervention needed\n- **Task tool for parallelism**: Subagents inspect polecats, not molecule arms\n\n## Patrol Shape (Linear, Deacon-style)\n\n```\ninbox-check ─► process-cleanups ─► check-refinery ─► survey-workers\n                                                            │\n         ┌──────────────────────────────────────────────────┘\n         ▼\n  check-timer-gates ─► check-swarm ─► ping-deacon ─► patrol-cleanup ─► context-check ─► loop-or-exit\n```\n\nNo dynamic arms. No fanout gates. No persistent nudge counters.\nState is discovered each cycle from reality (tmux, beads, mail).","status":"hooked","priority":2,"issue_type":"epic","assignee":"DietistApp/witness","created_at":"2026-01-27T14:00:12.485582+01:00","updated_at":"2026-01-27T14:00:17.361521+01:00","ephemeral":true}
{"id":"di-wisp-cmb.1","title":"Digest: mol-witness-patrol","description":"Patrol 2: Corrected worktree misunderstanding. All polecats functional (git at DietistApp/.git). Closed 2 orphaned MRs (di-clf, di-qzn - branches never pushed). Nudged 4 polecats toward completion/exit. Updated Mayor on situation.","status":"closed","priority":2,"issue_type":"task","owner":"jesper@logikfabriken.se","created_at":"2026-01-27T20:45:55.957266+01:00","created_by":"DietistApp/witness","updated_at":"2026-01-27T20:45:59.657529+01:00","closed_at":"2026-01-27T20:45:59.657529+01:00","close_reason":"Patrol cycle 2 complete","dependencies":[{"issue_id":"di-wisp-cmb.1","depends_on_id":"di-wisp-cmb","type":"parent-child","created_at":"2026-01-27T20:45:55.958043+01:00","created_by":"DietistApp/witness"}]}
{"id":"di-wisp-e1n","title":"Ensure refinery is alive","description":"Ensure the refinery is alive and processing merge requests.\n\n```bash\n# Check if refinery session exists\ngt session status \u003crig\u003e/refinery\n\n# Check for pending merge requests\nbd list --type=merge-request --status=open\n```\n\nIf MRs waiting AND refinery not running:\n```bash\ngt session start \u003crig\u003e/refinery\ngt mail send \u003crig\u003e/refinery -s \"PATROL: Wake up\" -m \"Merge requests in queue. Please process.\"\n```\n\nIf refinery running but queue stale (\u003e30 min), send nudge.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.061601+01:00","updated_at":"2026-01-27T14:06:02.061601+01:00","dependencies":[{"issue_id":"di-wisp-e1n","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.064605+01:00","created_by":"witness"},{"issue_id":"di-wisp-e1n","depends_on_id":"di-wisp-7r7","type":"blocks","created_at":"2026-01-27T14:06:02.070025+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-frp","title":"Check own context limit","description":"Check own context usage.\n\nIf context is HIGH (\u003e80%):\n- Ensure any notes are written to handoff mail\n- Prepare for session restart\n\nIf context is LOW:\n- Can continue patrolling","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.062669+01:00","updated_at":"2026-01-27T14:06:02.062669+01:00","dependencies":[{"issue_id":"di-wisp-frp","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.068063+01:00","created_by":"witness"},{"issue_id":"di-wisp-frp","depends_on_id":"di-wisp-hir","type":"blocks","created_at":"2026-01-27T14:06:02.073285+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-hir","title":"End-of-cycle inbox hygiene","description":"Verify inbox hygiene before ending patrol cycle.\n\n**Step 1: Check inbox state**\n```bash\ngt mail inbox\n```\n\nIn the ephemeral model, most POLECAT_DONE messages are handled immediately\n(auto-nuke) and archived. Inbox should contain ONLY:\n- Unprocessed messages (just arrived, will handle next cycle)\n- MERGED notifications (informational, archive after reading)\n\n**Step 2: Archive any stale messages**\n\nLook for messages that were processed but not archived:\n- POLECAT_STARTED older than this cycle → archive\n- POLECAT_DONE that was auto-nuked → should be archived already\n- MERGED notifications → archive after acknowledging\n- HELP/Blocked that was escalated → archive\n- SWARM_START that created tracking wisp → archive\n\n```bash\n# For each stale message found:\ngt mail archive \u003cmessage-id\u003e\n```\n\n**Step 3: Verify cleanup wisp hygiene**\n\nIn the ephemeral model, cleanup wisps should be rare (only for dirty polecats):\n```bash\nbd list --wisp --labels=cleanup --status=open\n```\n\n- state:pending → Needs investigation in process-cleanups\n- state:merge-requested → Legacy state, handle in inbox-check\n\nIf cleanup wisps are accumulating, investigate why polecats aren't clean.\n\n**Goal**: Inbox should be nearly empty. Cleanup wisps should be rare.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.062487+01:00","updated_at":"2026-01-27T14:06:02.062487+01:00","dependencies":[{"issue_id":"di-wisp-hir","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.067128+01:00","created_by":"witness"},{"issue_id":"di-wisp-hir","depends_on_id":"di-wisp-t1v","type":"blocks","created_at":"2026-01-27T14:06:02.072765+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-izl","title":"mol-witness-patrol","description":"Per-rig worker monitor patrol loop.\n\nThe Witness is the Pit Boss for your rig. You watch polecats, nudge them toward\ncompletion, verify clean git state before kills, and escalate stuck workers.\n\n**You do NOT do implementation work.** Your job is oversight, not coding.\n\n## Ephemeral Polecat Model\n\nPolecats are truly ephemeral - done at MR submission, recyclable immediately:\n\n```\nPolecat lifecycle: spawning → working → mr_submitted → nuked\nMR lifecycle:      created → queued → processed → merged (Refinery handles)\n```\n\nOnce a polecat's branch is pushed (cleanup_status=clean), the polecat can be\nnuked immediately. The MR continues independently in the Refinery. If conflicts\narise, Refinery creates a NEW conflict-resolution task for a NEW polecat.\n\n**Key principle**: Polecat lifecycle is separate from MR lifecycle.\n\n## Design Philosophy\n\nThis patrol follows Gas Town principles:\n- **Discovery over tracking**: Observe reality each cycle, don't maintain state\n- **Events over state**: POLECAT_DONE mail triggers immediate cleanup\n- **Ephemeral by default**: Clean polecats are nuked immediately, no waiting\n- **Cleanup wisps for exceptions**: Only created when intervention needed\n- **Task tool for parallelism**: Subagents inspect polecats, not molecule arms\n\n## Patrol Shape (Linear, Deacon-style)\n\n```\ninbox-check ─► process-cleanups ─► check-refinery ─► survey-workers\n                                                            │\n         ┌──────────────────────────────────────────────────┘\n         ▼\n  check-timer-gates ─► check-swarm ─► ping-deacon ─► patrol-cleanup ─► context-check ─► loop-or-exit\n```\n\nNo dynamic arms. No fanout gates. No persistent nudge counters.\nState is discovered each cycle from reality (tmux, beads, mail).","status":"open","priority":2,"issue_type":"epic","created_at":"2026-01-27T14:06:02.060541+01:00","updated_at":"2026-01-27T14:06:02.060541+01:00","ephemeral":true}
{"id":"di-wisp-lt8","title":"Inspect all active polecats","description":"Survey all polecats using agent beads (ZFC: trust what agents report).\n\n**Step 1: List polecat agent beads**\n\n```bash\nbd list --type=agent --json\n```\n\nFilter the JSON output for entries where description contains `role_type: polecat`.\nEach polecat agent bead has fields in its description:\n- `role_type: polecat`\n- `rig: \u003crig-name\u003e`\n- `agent_state: running|idle|stuck|done`\n- `hook_bead: \u003ccurrent-work-id\u003e`\n\n**Step 2: For each polecat, check agent_state**\n\n| agent_state | Meaning | Action |\n|-------------|---------|--------|\n| running | Actively working | Check progress (Step 3) |\n| idle | No work assigned | Auto-nuke if clean (Step 3a) |\n| stuck | Self-reported stuck | Handle stuck protocol |\n| done | Work complete | Verify cleanup triggered (see Step 4a) |\n\n**Step 3: For running polecats, assess progress**\n\nCheck the hook_bead field to see what they're working on:\n```bash\nbd show \u003chook_bead\u003e  # See current step/issue\n```\n\nYou can also verify they're responsive:\n```bash\ntmux capture-pane -t gt-\u003crig\u003e-\u003cname\u003e -p | tail -20\n```\n\nLook for:\n- Recent tool activity → making progress\n- Idle at prompt → may need nudge\n- Error messages → may need help\n\n**Step 3a: For idle polecats, auto-nuke if clean**\n\nWhen agent_state=idle, the polecat has no work assigned. Check if it's safe to nuke:\n\n```bash\n# Check git status in the polecat's worktree\ncd polecats/\u003cname\u003e\ngit status --porcelain         # Should be empty (clean)\ngit log origin/main..HEAD      # Should have no unpushed commits\n```\n\n**If clean** (no uncommitted changes, no unpushed commits):\n```bash\n# Safe to nuke - no work to lose\ngt polecat nuke \u003cname\u003e\n```\nLog the auto-nuke for audit purposes. No escalation needed.\n\n**If dirty** (uncommitted or unpushed work):\n```bash\n# Escalate to Mayor - polecat has work that might be valuable\ngt mail send mayor/ -s \\\"IDLE_DIRTY: \u003cpolecat\u003e has uncommitted work\\\" \\\n  -m \\\"Polecat: \u003cname\u003e\nState: idle (no hook_bead)\nGit status: \u003cuncommitted-files\u003e\nUnpushed commits: \u003ccount\u003e\n\nPlease advise: recover work or discard?\\\"\n```\n\n**Rationale**: Idle polecats with clean git state are pure overhead. They have\nno work and no state worth preserving. Nuking them immediately frees resources\nand reduces noise. Only escalate when there's actual work at risk.\n\n**Step 4: Decide action**\n\n| Observation | Action |\n|-------------|--------|\n| agent_state=running, recent activity | None |\n| agent_state=running, idle 5-15 min | Gentle nudge |\n| agent_state=running, idle 15+ min | Direct nudge with deadline |\n| agent_state=stuck | Assess and help or escalate |\n| agent_state=done | Verify cleanup triggered (see Step 4a) |\n\n**Step 4a: Handle agent_state=done**\n\nIn the ephemeral model, polecats with agent_state=done and cleanup_status=clean\nshould already be nuked by HandlePolecatDone. Finding one here indicates:\n\n1. **Stale agent bead** - polecat was nuked but bead remains\n   ```bash\n   # Verify polecat doesn't exist anymore\n   ls polecats/\u003cname\u003e 2\u003e/dev/null || echo \"Already nuked\"\n   ```\n   If nuked, the agent bead is stale. Clean it up or ignore.\n\n2. **Cleanup wisp exists** - polecat has dirty state needing intervention\n   ```bash\n   bd list --wisp --labels=polecat:\u003cname\u003e --status=open\n   ```\n   Process in process-cleanups step.\n\n3. **No wisp, polecat exists** - POLECAT_DONE mail was missed\n   Try auto-nuke directly (ephemeral model):\n   ```bash\n   # Check cleanup_status and nuke if clean\n   gt polecat nuke \u003cname\u003e  # Will fail if dirty\n   ```\n   If nuke fails (dirty state), create cleanup wisp for investigation.\n\n**Step 5: Execute nudges**\n```bash\ngt nudge \u003crig\u003e/polecats/\u003cname\u003e \"How's progress? Need help?\"\n```\n\n**Step 6: Escalate if needed**\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e stuck\" \\\n  -m \"Polecat \u003cname\u003e reports stuck. Please intervene.\"\n```\n\n**Parallelism**: Use Task tool subagents to inspect multiple polecats concurrently.\n\n**ZFC Principle**: Trust agent_state from beads. Don't infer state from PID/tmux.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T13:59:50.470939+01:00","updated_at":"2026-01-27T13:59:50.470939+01:00","ephemeral":true}
{"id":"di-wisp-t1v","title":"Ping Deacon for health check","description":"Send WITNESS_PING to Deacon for second-order monitoring.\n\nThe Witness fleet collectively monitors Deacon health - this prevents the\n\"who watches the watchers\" problem. If Deacon dies, Witnesses detect it.\n\n**Step 1: Send ping**\n```bash\ngt mail send deacon/ -s \"WITNESS_PING \u003crig\u003e\" -m \"Rig: \u003crig\u003e\nTimestamp: $(date -u +%Y-%m-%dT%H:%M:%SZ)\nPatrol: \u003ccycle-number\u003e\"\n```\n\n**Step 2: Check Deacon health**\n```bash\n# Check Deacon agent bead for last_activity\nbd list --type=agent --json | jq '.[] | select(.description | contains(\"deacon\"))'\n```\n\nLook at the `last_activity` timestamp. If stale (\u003e5 minutes since last update):\n- Deacon may be dead or stuck\n\n**Step 3: Escalate if needed**\n```bash\n# If Deacon appears down\ngt mail send mayor/ -s \"ALERT: Deacon appears unresponsive\" -m \"No Deacon activity for \u003e5 minutes.\nLast seen: \u003ctimestamp\u003e\nWitness: \u003crig\u003e/witness\"\n```\n\nNote: Multiple Witnesses may send this alert. Mayor should handle deduplication.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.062283+01:00","updated_at":"2026-01-27T14:06:02.062284+01:00","dependencies":[{"issue_id":"di-wisp-t1v","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.06666+01:00","created_by":"witness"},{"issue_id":"di-wisp-t1v","depends_on_id":"di-wisp-8pr","type":"blocks","created_at":"2026-01-27T14:06:02.072253+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wisp-wi6","title":"Inspect all active polecats","description":"Survey all polecats using agent beads (ZFC: trust what agents report).\n\n**Step 1: List polecat agent beads**\n\n```bash\nbd list --type=agent --json\n```\n\nFilter the JSON output for entries where description contains `role_type: polecat`.\nEach polecat agent bead has fields in its description:\n- `role_type: polecat`\n- `rig: \u003crig-name\u003e`\n- `agent_state: running|idle|stuck|done`\n- `hook_bead: \u003ccurrent-work-id\u003e`\n\n**Step 2: For each polecat, check agent_state**\n\n| agent_state | Meaning | Action |\n|-------------|---------|--------|\n| running | Actively working | Check progress (Step 3) |\n| idle | No work assigned | Auto-nuke if clean (Step 3a) |\n| stuck | Self-reported stuck | Handle stuck protocol |\n| done | Work complete | Verify cleanup triggered (see Step 4a) |\n\n**Step 3: For running polecats, assess progress**\n\nCheck the hook_bead field to see what they're working on:\n```bash\nbd show \u003chook_bead\u003e  # See current step/issue\n```\n\nYou can also verify they're responsive:\n```bash\ntmux capture-pane -t gt-\u003crig\u003e-\u003cname\u003e -p | tail -20\n```\n\nLook for:\n- Recent tool activity → making progress\n- Idle at prompt → may need nudge\n- Error messages → may need help\n\n**Step 3a: For idle polecats, auto-nuke if clean**\n\nWhen agent_state=idle, the polecat has no work assigned. Check if it's safe to nuke:\n\n```bash\n# Check git status in the polecat's worktree\ncd polecats/\u003cname\u003e\ngit status --porcelain         # Should be empty (clean)\ngit log origin/main..HEAD      # Should have no unpushed commits\n```\n\n**If clean** (no uncommitted changes, no unpushed commits):\n```bash\n# Safe to nuke - no work to lose\ngt polecat nuke \u003cname\u003e\n```\nLog the auto-nuke for audit purposes. No escalation needed.\n\n**If dirty** (uncommitted or unpushed work):\n```bash\n# Escalate to Mayor - polecat has work that might be valuable\ngt mail send mayor/ -s \\\"IDLE_DIRTY: \u003cpolecat\u003e has uncommitted work\\\" \\\n  -m \\\"Polecat: \u003cname\u003e\nState: idle (no hook_bead)\nGit status: \u003cuncommitted-files\u003e\nUnpushed commits: \u003ccount\u003e\n\nPlease advise: recover work or discard?\\\"\n```\n\n**Rationale**: Idle polecats with clean git state are pure overhead. They have\nno work and no state worth preserving. Nuking them immediately frees resources\nand reduces noise. Only escalate when there's actual work at risk.\n\n**Step 4: Decide action**\n\n| Observation | Action |\n|-------------|--------|\n| agent_state=running, recent activity | None |\n| agent_state=running, idle 5-15 min | Gentle nudge |\n| agent_state=running, idle 15+ min | Direct nudge with deadline |\n| agent_state=stuck | Assess and help or escalate |\n| agent_state=done | Verify cleanup triggered (see Step 4a) |\n\n**Step 4a: Handle agent_state=done**\n\nIn the ephemeral model, polecats with agent_state=done and cleanup_status=clean\nshould already be nuked by HandlePolecatDone. Finding one here indicates:\n\n1. **Stale agent bead** - polecat was nuked but bead remains\n   ```bash\n   # Verify polecat doesn't exist anymore\n   ls polecats/\u003cname\u003e 2\u003e/dev/null || echo \"Already nuked\"\n   ```\n   If nuked, the agent bead is stale. Clean it up or ignore.\n\n2. **Cleanup wisp exists** - polecat has dirty state needing intervention\n   ```bash\n   bd list --wisp --labels=polecat:\u003cname\u003e --status=open\n   ```\n   Process in process-cleanups step.\n\n3. **No wisp, polecat exists** - POLECAT_DONE mail was missed\n   Try auto-nuke directly (ephemeral model):\n   ```bash\n   # Check cleanup_status and nuke if clean\n   gt polecat nuke \u003cname\u003e  # Will fail if dirty\n   ```\n   If nuke fails (dirty state), create cleanup wisp for investigation.\n\n**Step 5: Execute nudges**\n```bash\ngt nudge \u003crig\u003e/polecats/\u003cname\u003e \"How's progress? Need help?\"\n```\n\n**Step 6: Escalate if needed**\n```bash\ngt mail send mayor/ -s \"Escalation: \u003cpolecat\u003e stuck\" \\\n  -m \"Polecat \u003cname\u003e reports stuck. Please intervene.\"\n```\n\n**Parallelism**: Use Task tool subagents to inspect multiple polecats concurrently.\n\n**ZFC Principle**: Trust agent_state from beads. Don't infer state from PID/tmux.","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-27T14:06:02.061779+01:00","updated_at":"2026-01-27T14:06:02.061779+01:00","dependencies":[{"issue_id":"di-wisp-wi6","depends_on_id":"di-wisp-izl","type":"parent-child","created_at":"2026-01-27T14:06:02.065146+01:00","created_by":"witness"},{"issue_id":"di-wisp-wi6","depends_on_id":"di-wisp-e1n","type":"blocks","created_at":"2026-01-27T14:06:02.07059+01:00","created_by":"witness"}],"ephemeral":true}
{"id":"di-wnb","title":"Add comprehensive unit and UI tests for all features","description":"dispatched_by: mayor\n\nCreate comprehensive test coverage for DietistApp:\n\n1. API Unit Tests (Jest):\n   - Auth controller/service tests (register, login, refresh)\n   - Foods controller/service tests (search, get by number, nutrients)\n   - Entries controller/service tests (CRUD operations)\n   - Recipes controller/service tests (CRUD operations)\n   - Clients controller/service tests\n\n2. Frontend Unit Tests (Vitest):\n   - Auth store tests\n   - Component tests for LoginPage, RegisterPage\n   - Service tests for API calls\n\n3. E2E/Integration Tests:\n   - User registration flow\n   - User login flow\n   - Food diary entry flow\n   - Recipe management flow\n\nEnsure all existing functionality is covered with tests.","status":"hooked","priority":1,"issue_type":"task","assignee":"DietistApp/polecats/amber","owner":"jesper@logikfabriken.se","created_at":"2026-01-30T09:20:21.654019+01:00","created_by":"jesper","updated_at":"2026-01-30T09:20:46.333863+01:00"}
{"id":"di-x1i","title":"Refinery Patrol","description":"Merge queue processor patrol loop with verification gates.","status":"open","priority":2,"issue_type":"molecule","owner":"jesper@logikfabriken.se","created_at":"2026-01-26T18:19:13.491895+01:00","created_by":"jesper","updated_at":"2026-01-26T18:19:13.491895+01:00"}
